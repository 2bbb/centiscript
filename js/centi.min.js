!function(a){function c(a,b,c){this.x=a,this.y=b,this.z=c}function l(a){return a*a*a*(a*(6*a-15)+10)}function m(a,b,c){return(1-c)*a+c*b}var b=a.perlin={};c.prototype.dot2=function(a,b){return this.x*a+this.y*b},c.prototype.dot3=function(a,b,c){return this.x*a+this.y*b+this.z*c};var d=[new c(1,1,0),new c(-1,1,0),new c(1,-1,0),new c(-1,-1,0),new c(1,0,1),new c(-1,0,1),new c(1,0,-1),new c(-1,0,-1),new c(0,1,1),new c(0,-1,1),new c(0,1,-1),new c(0,-1,-1)],e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],f=new Array(512),g=new Array(512);b.seed=function(a){a>0&&1>a&&(a*=65536),a=Math.floor(a),256>a&&(a|=a<<8);for(var b=0;256>b;b++){var c;c=1&b?e[b]^255&a:e[b]^255&a>>8,f[b]=f[b+256]=c,g[b]=g[b+256]=d[c%12]}},b.seed(0);var h=.5*(Math.sqrt(3)-1),i=(3-Math.sqrt(3))/6,j=1/3,k=1/6;b.simplex2=function(a,b){var c,d,e,p,q,j=(a+b)*h,k=Math.floor(a+j),l=Math.floor(b+j),m=(k+l)*i,n=a-k+m,o=b-l+m;n>o?(p=1,q=0):(p=0,q=1);var r=n-p+i,s=o-q+i,t=n-1+2*i,u=o-1+2*i;k&=255,l&=255;var v=g[k+f[l]],w=g[k+p+f[l+q]],x=g[k+1+f[l+1]],y=.5-n*n-o*o;0>y?c=0:(y*=y,c=y*y*v.dot2(n,o));var z=.5-r*r-s*s;0>z?d=0:(z*=z,d=z*z*w.dot2(r,s));var A=.5-t*t-u*u;return 0>A?e=0:(A*=A,e=A*A*x.dot2(t,u)),70*(c+d+e)},b.simplex3=function(a,b,c){var d,e,h,i,t,u,v,w,x,y,l=(a+b+c)*j,m=Math.floor(a+l),n=Math.floor(b+l),o=Math.floor(c+l),p=(m+n+o)*k,q=a-m+p,r=b-n+p,s=c-o+p;q>=r?r>=s?(t=1,u=0,v=0,w=1,x=1,y=0):q>=s?(t=1,u=0,v=0,w=1,x=0,y=1):(t=0,u=0,v=1,w=1,x=0,y=1):s>r?(t=0,u=0,v=1,w=0,x=1,y=1):s>q?(t=0,u=1,v=0,w=0,x=1,y=1):(t=0,u=1,v=0,w=1,x=1,y=0);var z=q-t+k,A=r-u+k,B=s-v+k,C=q-w+2*k,D=r-x+2*k,E=s-y+2*k,F=q-1+3*k,G=r-1+3*k,H=s-1+3*k;m&=255,n&=255,o&=255;var I=g[m+f[n+f[o]]],J=g[m+t+f[n+u+f[o+v]]],K=g[m+w+f[n+x+f[o+y]]],L=g[m+1+f[n+1+f[o+1]]],M=.5-q*q-r*r-s*s;0>M?d=0:(M*=M,d=M*M*I.dot3(q,r,s));var N=.5-z*z-A*A-B*B;0>N?e=0:(N*=N,e=N*N*J.dot3(z,A,B));var O=.5-C*C-D*D-E*E;0>O?h=0:(O*=O,h=O*O*K.dot3(C,D,E));var P=.5-F*F-G*G-H*H;return 0>P?i=0:(P*=P,i=P*P*L.dot3(F,G,H)),32*(d+e+h+i)},b.perlin2=function(a,b){var c=Math.floor(a),d=Math.floor(b);a-=c,b-=d,c=255&c,d=255&d;var e=g[c+f[d]].dot2(a,b),h=g[c+f[d+1]].dot2(a,b-1),i=g[c+1+f[d]].dot2(a-1,b),j=g[c+1+f[d+1]].dot2(a-1,b-1),k=l(a);return m(m(e,i,k),m(h,j,k),l(b))},b.perlin3=function(a,b,c){var d=Math.floor(a),e=Math.floor(b),h=Math.floor(c);a-=d,b-=e,c-=h,d=255&d,e=255&e,h=255&h;var i=g[d+f[e+f[h]]].dot3(a,b,c),j=g[d+f[e+f[h+1]]].dot3(a,b,c-1),k=g[d+f[e+1+f[h]]].dot3(a,b-1,c),n=g[d+f[e+1+f[h+1]]].dot3(a,b-1,c-1),o=g[d+1+f[e+f[h]]].dot3(a-1,b,c),p=g[d+1+f[e+f[h+1]]].dot3(a-1,b,c-1),q=g[d+1+f[e+1+f[h]]].dot3(a-1,b-1,c),r=g[d+1+f[e+1+f[h+1]]].dot3(a-1,b-1,c-1),s=l(a),t=l(b),u=l(c);return m(m(m(i,o,s),m(j,p,s),u),m(m(k,q,s),m(n,r,s),u),t)}}(this);
(function(e,t){if(typeof define==="function"&&define.amd){define(["exports"],t)}else if(typeof exports==="object"){t(exports)}else{t(e.commonJsStrict={})}})(this,function(e){function t(e,t,n){this.obj=e;this.left=null;this.right=null;this.parent=n;this.dimension=t}function n(e,n,i){function o(e,n,r){var s=n%i.length,u,a;if(e.length===0){return null}if(e.length===1){return new t(e[0],s,r)}e.sort(function(e,t){return e[i[s]]-t[i[s]]});u=Math.floor(e.length/2);a=new t(e[u],s,r);a.left=o(e.slice(0,u),n+1,a);a.right=o(e.slice(u+1),n+1,a);return a}function u(e){function t(e){if(e.left){e.left.parent=e;t(e.left)}if(e.right){e.right.parent=e;t(e.right)}}s.root=e;t(s.root)}var s=this;if(!Array.isArray(e))u(e,n,i);else this.root=o(e,0,null);this.toJSON=function(e){if(!e)e=this.root;var n=new t(e.obj,e.dimension,null);if(e.left)n.left=s.toJSON(e.left);if(e.right)n.right=s.toJSON(e.right);return n};this.insert=function(e){function n(t,r){if(t===null){return r}var s=i[t.dimension];if(e[s]<t.obj[s]){return n(t.left,t)}else{return n(t.right,t)}}var r=n(this.root,null),s,o;if(r===null){this.root=new t(e,0,null);return}s=new t(e,(r.dimension+1)%i.length,r);o=i[r.dimension];if(e[o]<r.obj[o]){r.left=s}else{r.right=s}};this.remove=function(e){function n(t){if(t===null){return null}if(t.obj===e){return t}var r=i[t.dimension];if(e[r]<t.obj[r]){return n(t.left,t)}else{return n(t.right,t)}}function r(e){function u(e,t){var n,r,s,o,a;if(e===null){return null}n=i[t];if(e.dimension===t){if(e.right!==null){return u(e.right,t)}return e}r=e.obj[n];s=u(e.left,t);o=u(e.right,t);a=e;if(s!==null&&s.obj[n]>r){a=s}if(o!==null&&o.obj[n]>a.obj[n]){a=o}return a}function a(e,t){var n,r,s,o,u;if(e===null){return null}n=i[t];if(e.dimension===t){if(e.left!==null){return a(e.left,t)}return e}r=e.obj[n];s=a(e.left,t);o=a(e.right,t);u=e;if(s!==null&&s.obj[n]<r){u=s}if(o!==null&&o.obj[n]<u.obj[n]){u=o}return u}var t,n,o;if(e.left===null&&e.right===null){if(e.parent===null){s.root=null;return}o=i[e.parent.dimension];if(e.obj[o]<e.parent.obj[o]){e.parent.left=null}else{e.parent.right=null}return}if(e.left!==null){t=u(e.left,e.dimension)}else{t=a(e.right,e.dimension)}n=t.obj;r(t);e.obj=n}var t;t=n(s.root);if(t===null){return}r(t)};this.nearest=function(e,t,o){function l(r){function d(e,n){f.push([e,n]);if(f.size()>t){f.pop()}}var s,o=i[r.dimension],u=n(e,r.obj),a={},c,h,p;for(p=0;p<i.length;p+=1){if(p===r.dimension){a[i[p]]=e[i[p]]}else{a[i[p]]=r.obj[i[p]]}}c=n(a,r.obj);if(r.right===null&&r.left===null){if(f.size()<t||u<f.peek()[1]){d(r,u)}return}if(r.right===null){s=r.left}else if(r.left===null){s=r.right}else{if(e[o]<r.obj[o]){s=r.left}else{s=r.right}}l(s);if(f.size()<t||u<f.peek()[1]){d(r,u)}if(f.size()<t||Math.abs(c)<f.peek()[1]){if(s===r.left){h=r.right}else{h=r.left}if(h!==null){l(h)}}}var u,a,f;f=new r(function(e){return-e[1]});if(o){for(u=0;u<t;u+=1){f.push([null,o])}}l(s.root);a=[];for(u=0;u<t;u+=1){if(f.content[u][0]){a.push([f.content[u][0].obj,f.content[u][1]])}}return a};this.balanceFactor=function(){function e(t){if(t===null){return 0}return Math.max(e(t.left),e(t.right))+1}function t(e){if(e===null){return 0}return t(e.left)+t(e.right)+1}return e(s.root)/(Math.log(t(s.root))/Math.log(2))}}function r(e){this.content=[];this.scoreFunction=e}r.prototype={push:function(e){this.content.push(e);this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0];var t=this.content.pop();if(this.content.length>0){this.content[0]=t;this.sinkDown(0)}return e},peek:function(){return this.content[0]},remove:function(e){var t=this.content.length;for(var n=0;n<t;n++){if(this.content[n]==e){var r=this.content.pop();if(n!=t-1){this.content[n]=r;if(this.scoreFunction(r)<this.scoreFunction(e))this.bubbleUp(n);else this.sinkDown(n)}return}}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){var t=this.content[e];while(e>0){var n=Math.floor((e+1)/2)-1,r=this.content[n];if(this.scoreFunction(t)<this.scoreFunction(r)){this.content[n]=t;this.content[e]=r;e=n}else{break}}},sinkDown:function(e){var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);while(true){var i=(e+1)*2,s=i-1;var o=null;if(s<t){var u=this.content[s],a=this.scoreFunction(u);if(a<r)o=s}if(i<t){var f=this.content[i],l=this.scoreFunction(f);if(l<(o==null?r:a)){o=i}}if(o!=null){this.content[e]=this.content[o];this.content[o]=n;e=o}else{break}}}};this.kdTree=n;e.kdTree=n;e.BinaryHeap=r})
function evalInContext(source,context){function values(){var e=[];for(var t in context)if(context.hasOwnProperty(t))e.push(context[t]);return e}source="(function("+Object.keys(context).join(", ")+") {"+source+"})";var compiled=eval(source);return compiled.apply(context,values())}function get_url_vars(){var e=new Object;var t;var n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var r=0;r<n.length;r++){t=n[r].split("=");if(t.length==2){e[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}}return e}function checkFileReaderApi(){return window.File&&window.FileReader&&window.FileList&&window.Blob}function checkFileWriterApi(){return window.File&&window.saveAs&&window.FileList&&window.Blob}function getAudioContext(){if(audioContext)return audioContext;if(!audioContext&&audioContextClass)return audioContext=new audioContextClass;else return null}function getAudioAnalyser(){return audioAnalyser||(audioAnalyser=getAudioContext().createAnalyser())}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}()}window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;if(!window.XMLHttpRequest){XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}}var audioContext=null;var audioContextClass=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext;var audioAnalyser=null;if(!Array.prototype.forEach){Array.prototype.forEach=function(e,t){for(var n=0;n<this.length;n++){e.call(t||null,this[n],n,this)}}}var MATH_PROPS=["E","LN2","LN10","LOG2E","LOG10E","PI","PI2","SQRT1_2","SQRT2"];var MATHS=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","imul","log","max","min","pow","random","round","sin","sqrt","tan"];var CTX_FUNCS=Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype);PI2=Math.PI2=Math.PI*2;var Centi=function(e){this.ver="0.3.8";this.name=e?e:"ct";this.canvas=null;this.ctx=null;this.dsp={enable:false,context:null,analyser:null,processor:null};this.sampleRate=44100;this.fft=new Uint8Array(1024);this.waveUint=new Uint8Array(2048);this.wave=new Float32Array(2048);this.GOLD=(1+Math.sqrt(5))/2;this.x=0;this.y=0;this.c=0;this.time=0;this.w=720;this.h=360;this.sizeW=this.w;this.sizeH=this.h;this.cx=this.w/2;this.cy=this.h/2;this.tempo={bpm:120,sec:.5,preSec:0,divide:4};this.beat=0;this.initSec=this.now();this.bgcolor={r:0,g:0,b:0};this.bFill=true;this.kdtree;this.setupMethod="";this.drawMethod="";this.beatMethod="";this.dspMethod="";this.setupFunc=null;this.drawFunc=null;this.beatFunc=null;this.dspFunc=null;this.toGifFunc=null;this.b3d=false;this.pluginInstances=[]};Centi.plugins=[];Centi.prototype.destroy=function(){if(this.dsp.processor){this.dsp.processor.disconnect();this.dsp.processor.onaudioprocess=null;this.dsp.processor=null}if(this.dsp.analyser){this.dsp.analyser.disconnect();this.dsp.analyser=null}if(this.dsp.context){this.dsp.context.distination.disconnect()}this.dsp.context=null;this.canvas=null;this.ctx=null;this.dsp=null;this.tempo=null;this.toGifFunc=null;this.setupFunc=null;this.drawFunc=null;this.beatFunc=null;this.dspFunc=null;this.fft=null;this.wave=null;this.b3d=false;this.pluginInstances=null};Centi.prototype.init=function(e,t){this.canvas=e;this.initSec=this.now();this.time=0;if(t){this.dsp.enable=true;this.dsp.context=t;this.dsp.context.createScriptProcessor=this.dsp.context.createScriptProcessor||this.dsp.context.createJavaScriptNode;var n=function(){if(/(Win(dows )?NT 6\.2)/.test(navigator.userAgent)){return 1024}else if(/(Win(dows )?NT 6\.1)/.test(navigator.userAgent)){return 1024}else if(/(Win(dows )?NT 6\.0)/.test(navigator.userAgent)){return 2048}else if(/Win(dows )?(NT 5\.1|XP)/.test(navigator.userAgent)){return 4096}else if(/Mac|PPC/.test(navigator.userAgent)){return 4096}else if(/Linux/.test(navigator.userAgent)){return 8192}else if(/iPhone|iPad|iPod/.test(navigator.userAgent)){return 2048}else{return 16384}};this.dsp.analyser=this.dsp.context.createAnalyser();this.dsp.analyser.connect(this.dsp.context.destination);this.sampleRate=this.dsp.context.sampleRate;var r=1/this.dsp.context.sampleRate;var i=this.dsp.context.createScriptProcessor(n(),0,2);this.dsp.processor=i;var s=this.dsp.context.createBufferSource();s.connect(i);i.connect(this.dsp.analyser);var o=this;i.onaudioprocess=function(e){o.updateBeat();var t=e.outputBuffer.getChannelData(0);var n=e.outputBuffer.getChannelData(1);for(var i=0;i<this.bufferSize;i++){var s=o.time;var u=o.doDsp();t[i]=u;n[i]=u;o.time+=r}}}else{this.dsp.enable=false}for(var u=0;u<Centi.plugins.length;u++){var a=new Centi.plugins[u](this);this.pluginInstances.push(a)}if(e.getContext){return true}else{return false}};Centi.prototype.doDsp=function(){return this.dspFunc?this.dspFunc():0};Centi.prototype.parse=function(e){function g(e,t){e=e.replace(c,t+"."+"$1"+"$2");e=e.replace(l,"$2");e=e.replace(s,"for(");e=e.replace(o,"while(");e=e.replace(u,"if(");e=e.replace(a,"else{");e=e.replace(f,"else if(");e=e.replace(h,"function(");e=e.replace(p,"arguments["+"$2"+"]");e=e.replace(d,"return (");e=e.replace(v,".");for(var n=0;n<m.length;n++){var r=new RegExp(t+"."+m[n].prefix+".","g");e=e.replace(r,m[n].prefix+".");if(m[n].shortPrefix){r=new RegExp(t+"."+m[n].shortPrefix+".","g");e=e.replace(r,m[n].prefix+".")}}for(var n=0;n<MATHS.length;n++){var i=t+"."+MATHS[n]+"\\(";e=e.replace(new RegExp(i,"g"),"Math."+MATHS[n]+"(")}for(var n=0;n<MATH_PROPS.length;n++){e=e.replace(new RegExp(t+"."+MATH_PROPS[n],"g"),"Math."+MATH_PROPS[n])}return e}e=e.replace(/\s/g,"");e=e.replace(/\b/g,"");e=e.replace(/(\))([A-Za-z0-9_\}])/g,");$2");e=e.replace(/(for\()([A-Za-z_\-\.\(\)]+)(\,)([A-Za-z0-9_\-\.\(\)]+)(\,)([A-Za-z0-9_\-\.\(\)\*\+\/]+)(\))/g,"for($2=$4;$2<$6;$2++)");var t=this.getInnerExpression(e.slice(e.indexOf("frame(")));var n=this.getInnerExpression(e.slice(e.indexOf("beat(")));var r=this.getInnerExpression(e.slice(e.indexOf("dsp(")));var i=e.replace("frame(){"+t+"}","");i=i.replace("beat(){"+n+"}","");i=i.replace("dsp(){"+r+"}","");if(/c3d\(\)/.test(i))this.c3d();else this.c2d();var s=new RegExp(this.name+".for\\(","g");var o=new RegExp(this.name+".while\\(","g");var u=new RegExp(this.name+".if\\(","g");var a=new RegExp(this.name+".else\\{","g");var f=new RegExp(this.name+".elseIf\\(","g");var l=new RegExp("("+this.name+").([0-9.]+)","g");var c=/([A-Za-z0-9_]+)([\.\!\~\|\%\&\:\(\)\{\}\;\=\+\-\<\>\*\/\[\]\,\^])/g;var h=new RegExp(this.name+".func\\(","g");var p=/(\$)([0-9]+)/g;var d=new RegExp(this.name+".return\\(","g");var v=new RegExp("\\."+this.name+"\\.","g");var m=this.pluginInstances;i=g(i,this.name);i=this.modFunction(i);t=g(t,this.name);t=this.modFunction(t);n=g(n,this.name);n=this.modFunction(n);r=g(r,this.name);r=this.modFunction(r);this.drawMethod=t;this.beatMethod=n;this.dspMethod=r;if(this.drawMethod!=""){this.drawFunc=evalInContext("return (function(){"+this.drawMethod+"});",this)}else{this.drawFunc=null}if(this.beatMethod!=""){this.beatFunc=evalInContext("return (function(){"+this.beatMethod+"});",this)}else{this.beatFunc=null}if(this.dspMethod!=""){this.dspFunc=evalInContext("return (function(){"+this.dspMethod+"});",this)}else{this.dspFunc=null}this.setupMethod=i;if(this.setupMethod!=""){this.setupFunc=evalInContext("return (function(){"+this.setupMethod+"});",this)}else{this.setupFunc=null}return true};Centi.prototype.start=function(){for(var e=0;e<this.pluginInstances.length;e++){this.pluginInstances[e].preSetup()}if(this.b3d==false){this.ctx=this.canvas.getContext("2d");this.clear()}this.reset();this.bg(0);this.bpm(120,4);if(this.setupFunc)this.setupFunc();for(var e=0;e<this.pluginInstances.length;e++){this.pluginInstances[e].postSetup()}};Centi.prototype.modFunction=function(e){var t=(e.match(/function/g)||[]).length;if(t>0){var n=e;var r=0;r=n.indexOf("function",r)+7;var i=0;var s=i;while(r<n.length){var o=n.charAt(r);if(o=="{")i++;if(o=="}")i--;if(s==1&&i==0){n=n.slice(0,r+1)+";"+n.slice(r+1);t--;if(t>0)r=n.indexOf("function",r)+7;else if(t==0)break}s=i;r++}e=n}return e};Centi.prototype.getInnerExpression=function(e){var t=e;var n=0;var r=0;n=r=t.indexOf("{",r);if(n==-1)return"";var i=0;var s=i;while(r<t.length){var o=t.charAt(r);if(o=="{")i++;if(o=="}")i--;if(s==1&&i==0){t=t.slice(n+1,r);break}s=i;r++}if(i==0)return t;else return""};Centi.prototype.update=function(){for(var e=0;e<this.pluginInstances.length;e++){this.pluginInstances[e].preUpdate()}if(this.dsp.enable==false){this.time=this.now()-this.initSec;this.updateBeat()}else{this.dsp.analyser.getByteFrequencyData(this.fft);this.dsp.analyser.getByteTimeDomainData(this.waveUint);for(var e=0;e<this.waveUint.length;e++){this.wave[e]=(this.waveUint[e]/255-.5)*2}}if(this.drawFunc)this.drawFunc();for(var e=0;e<this.pluginInstances.length;e++){this.pluginInstances[e].postUpdate()}this.c++;if(this.toGifFunc!=null)this.toGifFunc(this.ctx)};Centi.prototype.updateBeat=function(){if(this.time-this.tempo.preSec>=this.tempo.sec){if(this.beatFunc)this.beatFunc();this.tempo.preSec=this.time;this.beat++}};Centi.prototype.reset=function(){this.c=0;this.initSec=this.now();this.time=0;this.bFill=true;this.lw(1);this.lj(0);this.lc(0);this.bm(0)};Centi.prototype.c2d=function(){this.b3d=false};Centi.prototype.c3d=function(){this.b3d=true};Centi.prototype.bg=function(){if(this.ctx==null)return;var e=arguments.length;if(e==1){this.bgcolor.r=parseInt(arguments[0]);this.bgcolor.g=parseInt(arguments[0]);this.bgcolor.b=parseInt(arguments[0])}else if(e==3){this.bgcolor.r=parseInt(arguments[0]);this.bgcolor.g=parseInt(arguments[1]);this.bgcolor.b=parseInt(arguments[2])}this.clear()};Centi.prototype.lg=function(){console.log(arguments)};Centi.prototype.log=function(){console.log(arguments)};Centi.prototype.sz=function(e,t){this.size(e,t)};Centi.prototype.size=function(e,t){this.sizeW=e;this.sizeH=t;var n,r;if(e<=1)n=window.innerWidth*e;else n=e;if(t<=1)r=window.innerHeight*t;else r=t;this.w=n;this.h=r;this.canvas.width=this.w;this.canvas.height=this.h;this.cx=this.w/2;this.cy=this.h/2};Centi.prototype.clr=function(){this.clear()};Centi.prototype.clear=function(){if(this.ctx==null)return;var e=this.ctx.globalCompositeOperation;this.ctx.globalCompositeOperation="source-over";this.ctx.fillStyle="rgb("+this.bgcolor.r+","+this.bgcolor.g+","+this.bgcolor.b+")";this.ctx.fillRect(0,0,this.w,this.h);this.ctx.globalCompositeOperation=e};Centi.prototype.Obj=function(){return new Object};Centi.prototype.obj=function(){return new Object};Centi.prototype.rnd=function(){return this.rand.apply(this,arguments)};Centi.prototype.rand=function(){var e=arguments.length;if(e==1){return Math.random()*arguments[0]}else if(e==2){return Math.random()*(arguments[1]-arguments[0])+arguments[0]}else{return Math.random()}};Centi.prototype.nz=function(){return this.noise.apply(this,arguments)};Centi.prototype.noise=function(){var e=arguments.length;if(e==1){return perlin.perlin2(arguments[0],0)}else if(e==2){return perlin.perlin2(arguments[0],arguments[1])}else if(e==3){return perlin.perlin3(arguments[0],arguments[1],arguments[2])}return 0};Centi.prototype.tri=function(){};Centi.prototype.tri=function(){if(this.ctx==null)return;if(arguments.length==6){this.beginShape();this.moveTo(arguments[0],arguments[1]);this.lineTo(arguments[2],arguments[3]);this.lineTo(arguments[4],arguments[5]);this.lineTo(arguments[0],arguments[1]);this.endShape()}else if(arguments.length==3){this.beginShape();this.moveTo(arguments[0].x,arguments[0].y);this.lineTo(arguments[1].x,arguments[1].y);this.lineTo(arguments[2].x,arguments[2].y);this.lineTo(arguments[0].x,arguments[0].y);this.endShape()}};Centi.prototype.rect=function(e,t,n,r){if(this.ctx==null)return;if(this.bFill)this.ctx.fillRect(e,t,n,r);else this.ctx.strokeRect(e,t,n,r)};Centi.prototype.oval=function(e,t,n,r){if(this.ctx==null)return;r=r||-1;if(r==-1){this.ctx.beginPath();this.ctx.arc(e,t,n,0,Math.PI*2,true);if(this.bFill)this.ctx.fill();else this.ctx.stroke()}else{if(r<3)r=3;var i=Math.PI2/r;this.ctx.beginPath();for(var s=0;s<r;s++){var o=Math.cos(i*s)*n+e;var u=Math.sin(i*s)*n+t;var a=Math.cos(i*(s+1))*n+e;var f=Math.sin(i*(s+1))*n+t;this.lineTo(o,u);this.lineTo(a,f)}if(this.bFill)this.ctx.fill();else this.ctx.stroke()}};Centi.prototype.ln=function(e,t,n,r){this.line(e,t,n,r)};Centi.prototype.line=function(e,t,n,r){if(this.ctx==null)return;this.ctx.beginPath();this.ctx.moveTo(e,t);this.ctx.lineTo(n,r);this.ctx.stroke()};Centi.prototype.curve=function(){if(this.ctx==null)return;if(arguments.length==8){this.beginShape();this.moveTo(arguments[0],arguments[1]);this.curveTo(arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);this.endShape()}else if(arguments.length==1){if(arguments[0].length&&arguments[0].length==8){this.curve(arguments[0][0],arguments[0][1],arguments[0][2],arguments[0][3],arguments[0][4],arguments[0][5],arguments[0][6],arguments[0][7])}}};Centi.prototype.moveTo=function(e,t){if(this.ctx==null)return;this.ctx.moveTo(e,t)};Centi.prototype.lineTo=function(e,t){if(this.ctx==null)return;this.ctx.lineTo(e,t)};Centi.prototype.curveTo=function(){if(this.ctx==null)return;if(arguments.length==6){this.ctx.bezierCurveTo(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])}else if(arguments.length==1){if(arguments[0].length&&arguments[0].length==6){this.ctx.bezierCurveTo(arguments[0][0],arguments[0][1],arguments[0][2],arguments[0][3],arguments[0][4],arguments[0][5])}}};Centi.prototype.beginShape=function(){if(this.ctx==null)return;this.ctx.beginPath()};Centi.prototype.endShape=function(){if(this.ctx==null)return;if(this.bFill)this.ctx.fill();else this.ctx.stroke()};Centi.prototype.me=function(){this.drawMe.apply(this,arguments)};Centi.prototype.drawMe=function(){if(this.ctx==null)return;var e=arguments.length;if(e==2){this.ctx.drawImage(this.canvas,arguments[0],arguments[1])}else if(e==4){this.ctx.drawImage(this.canvas,arguments[0],arguments[1],arguments[2],arguments[3])}else if(e==8){this.ctx.drawImage(this.canvas,arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7])}};Centi.prototype.lw=function(e){this.lineWidth(e)};Centi.prototype.lineWidth=function(e){if(this.ctx==null)return;this.ctx.lineWidth=e};Centi.prototype.lj=function(e){this.lineJoin(e)};Centi.prototype.lineJoin=function(e){if(this.ctx==null)return;if(e==0)this.ctx.lineJoin="bevel";else if(e==1)this.ctx.lineJoin="round";else if(e==2)this.ctx.lineJoin="miter"};Centi.prototype.lc=function(e){this.lineCap(e)};Centi.prototype.lineCap=function(e){if(this.ctx==null)return;if(e==0)this.ctx.lineCap="butt";else if(e==1)this.ctx.lineCap="round";else if(e==2)this.ctx.lineCap="square"};Centi.prototype.bm=function(e){this.blendMode(e)};Centi.prototype.blendMode=function(e){if(this.ctx==null)return;var t="source-over";var n=["source-over","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"];if(e<n.length){t=n[e];this.ctx.globalCompositeOperation=t}};Centi.prototype.hcol=function(e){this.col(e>>16&255,e>>8&255,e&255)};Centi.prototype.col=function(){var e=arguments.length;var t="rgb(0,0,0)";if(e==1){t="rgb("+parseInt(arguments[0])+","+parseInt(arguments[0])+","+parseInt(arguments[0])+")"}else if(e==2){t="rgba("+parseInt(arguments[0])+","+parseInt(arguments[0])+","+parseInt(arguments[0])+","+parseInt(arguments[1])/255+")"}else if(e==3){t="rgb("+parseInt(arguments[0])+","+parseInt(arguments[1])+","+parseInt(arguments[2])+")"}else if(e==4){t="rgba("+parseInt(arguments[0])+","+parseInt(arguments[1])+","+parseInt(arguments[2])+","+parseInt(arguments[3])/255+")"}this.ctx.fillStyle=t;this.ctx.strokeStyle=t};Centi.prototype.fill=function(){this.bFill=true};Centi.prototype.strk=function(){this.stroke()};Centi.prototype.stroke=function(){this.bFill=false};Centi.prototype.push=function(){if(this.ctx==null)return;this.ctx.save()};Centi.prototype.pop=function(){if(this.ctx==null)return;this.ctx.restore()};Centi.prototype.rotate=function(e){if(this.ctx==null)return;this.ctx.rotate(e)};Centi.prototype.scale=function(e,t){if(this.ctx==null)return;this.ctx.scale(e,t)};Centi.prototype.translate=function(e,t){if(this.ctx==null)return;this.ctx.translate(e,t)};Centi.prototype.transform=function(e,t,n,r,i,s){if(this.ctx==null)return;this.ctx.transform(e,t,n,r,i,s)};Centi.prototype.drawFFT=function(e,t,n,r,i,s){var o=s||2;var u=i||9;var a=this.fft.length;var f=n/a;var l=r/255;for(var c=0;c<a;c+=u){this.rect(e+c*f,t+r,o,-this.fft[c]*l)}};Centi.prototype.drawWave=function(e,t,n,r,i){var s=i||9;var o=this.wave.length;var u=n/(o-1);var a=r/2;this.beginShape();for(var f=0;f<o;f+=s){this.lineTo(e+f*u,t+a+this.wave[f]*a)}this.endShape()};Centi.prototype.interp=function(e,t,n){return t+(e-t)*n};Centi.prototype.dist=function(){var e=arguments.length;if(e==4){var t=arguments[0]-arguments[2];var n=arguments[1]-arguments[3];return Math.sqrt(t*t+n*n)}else if(e==2&&arguments[0].hasOwnProperty("x")&&arguments[0].hasOwnProperty("y")&&arguments[1].hasOwnProperty("x")&&arguments[1].hasOwnProperty("y")){return this.dist(arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y)}};Centi.prototype.wrap=function(e,t,n){var r=n-t;if(r>0){if(e<t)e+=r;if(e>n)e-=r;return e}else{return e}};Centi.prototype.minmax=function(e,t,n){return this.minMax(e,t,n)};Centi.prototype.minMax=function(e,t,n){return Math.min(n,Math.max(e,t))};Centi.prototype.map=function(e,t,n,r,i){return(e-t)/(n-t)*(i-r)+r};Centi.prototype.zmap=function(e,t,n,r,i){return this.minMax(this.map(e,t,n,r,i),r,i)};Centi.prototype.avg=function(e){if(e&&e.length>0){var t=e.length;var n=0;for(var r=0;r<t;r++){n+=e[r]}return n/t}else{return 0}};Centi.prototype.cent=function(){var e=arguments.length;if(e==1&&arguments[0].length>1){e=arguments[0].length;var t={x:0,y:0};var n=0;for(var r=0;r<e;r++){var i=arguments[0][r];var s=arguments[0][(r+1)%e];t.x+=(i.x+s.x)*(i.x*s.y-s.x*i.y);t.y+=(i.y+s.y)*(i.x*s.y-s.x*i.y);n+=i.x*s.y-s.x*i.y}n=n/2;t.x=t.x/(6*n);t.y=t.y/(6*n);return t}else{return{x:0,y:0}}};Centi.prototype.curves=function(){var e=arguments.length;if(e==9){return this.getPointsOnCurve(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8])}else if(e==2){if(arguments[1].length&&arguments[1].length==8){return this.getPointsOnCurve(arguments[0],arguments[1][0],arguments[1][1],arguments[1][2],arguments[1][3],arguments[1][4],arguments[1][5],arguments[1][6],arguments[1][7])}}else if(e==1){if(arguments[0].length&&arguments[0].length==9){return this.getPointsOnCurve(arguments[0][0],arguments[0][1],arguments[0][2],arguments[0][3],arguments[0][4],arguments[0][5],arguments[0][6],arguments[0][7],arguments[0][8])}}};Centi.prototype.getPointsOnCurve=function(e,t,n,r,i,s,o,u,a){if(e<2)e=2;var f=[];for(var l=0;l<e;l++){var c=l/(e-1);f.push(this.getPointOnCubicBezier(c,t,r,s,u));f.push(this.getPointOnCubicBezier(c,n,i,o,a))}return f};Centi.prototype.getPointOnCubicBezier=function(e,t,n,r,i){var s=1-e;return s*s*s*t+3*s*s*e*n+3*s*e*e*r+e*e*e*i};Centi.prototype.radToDeg=function(e){return this.r2d(e)};Centi.prototype.r2d=function(e){return e*180/Math.PI};Centi.prototype.degToRad=function(e){return this.d2r(e)};Centi.prototype.d2r=function(e){return e*Math.PI/180};Centi.prototype.tree=function(e){function t(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)}this.kdtree=new kdTree(e,t,["x","y"])};Centi.prototype.nears=function(e,t,n){return this.kdtree.nearest(e,t,n)};Centi.prototype.bpm=function(e,t){this.tempo.bpm=e?e:120;this.tempo.divide=t?t:4;this.tempo.sec=60/this.tempo.bpm*4/this.tempo.divide;this.tempo.preSec=this.time};Centi.prototype.noteToFreq=function(e){return this.n2f(e)};Centi.prototype.n2f=function(e){return Math.pow(2,(e-69)/12)*440};Centi.prototype.sortNum=function(e){e.sort(function(e,t){if(e<t)return-1;if(e>t)return 1;return 0})};Centi.prototype.reverse=function(e){e.reverse()};Centi.prototype.fold=function(e){if(e.reduce){return e.reduce(function(e,t){return e+t})}else{var t=0;for(var n=0;n<e.length;n++)t+=e[n];return t}};Centi.prototype.Vec2=function(e,t){return new Centi.Vec2(e,t)};Centi.prototype.vec2=function(e,t){return new Centi.Vec2(e,t)};Centi.Vec2=function(e,t){this.x=e;this.y=t};Centi.prototype.now=function(){return(new Date).getTime()/1e3};Centi.prototype.grid=function(e,t,n,r){var i=e/n;var s=t/r;var o,u;var a=[];for(o=0;o<n;o++){for(u=0;u<r;u++){a.push({ix:o,iy:u,x:o*i,y:u*s,w:i,h:s})}}return a};Centi.prototype.new=function(e,t){function n(){e.apply(this,t)}n.prototype=e.prototype;return new n};Centi.prototype.seg=function(e,t,n,r,i){var s=[1,2,11,19,20,29,37];var o=[119,36,93,109,46,107,123,37,127,111];if(e>9)e=9;var u=o[e];for(var a=0;a<7;a++){if(u&1){var f=s[a]&7;var l=s[a]>>3;ct.line(t+r*(f&1),n+.5*i*(f>>1),t+r*(l&1),n+.5*i*(l>>1))}u=u>>1}};var CT_FUNCS=Object.getOwnPropertyNames(Centi.prototype)